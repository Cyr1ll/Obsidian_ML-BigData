# Порог принятия решения

## Введение
**Порог принятия решения** (decision threshold) — это значение, которое используется в задачах классификации для преобразования вероятности, предсказанной моделью, в окончательное решение о классе объекта. Этот порог определяет, при какой вероятности объект будет отнесен к одному из классов.**![](https://lh7-rt.googleusercontent.com/docsz/AD_4nXebfR9dtXs-V4qVsjjgngOPiKrWXDAX2V2zLceC75S5KlNvRQEoOdOho8RccrrfPUinoTfJZ2CxWj-yaZZCDCzZDXq3yANirHN08mSnL10gtY_JUcFtPU22TXu-Nn25159BLNqbqLRA6nwPOEcBLuOT2LDk?key=C1AMzwFdvttb7H1YBkknyQ)**

## Принцип работы
В задачах классификации, например, в бинарной классификации, модель часто выдает вероятность принадлежности объекта к положительному классу. Порог принятия решения определяет, какое значение вероятности должно быть достигнуто для того, чтобы объект был классифицирован как положительный.

- Если вероятность предсказания больше или равна порогу, объект классифицируется как положительный класс (например, класс 1).
- Если вероятность меньше порога, объект классифицируется как отрицательный класс (например, класс 0).

### Формально:
- Если $P(y = 1 | x) \geq \theta$, то объект классифицируется как класс 1.
- Если $P(y = 1 | x) < \theta$, то объект классифицируется как класс 0.

Здесь:
- $P(y = 1 | x)$ — это вероятность принадлежности объекта к положительному классу.
- $\theta$ — это порог принятия решения.

## Выбор порога
Выбор порога может существенно повлиять на производительность модели. Важно подобрать такой порог, который оптимизирует метрики качества модели, такие как точность (accuracy), полнота (recall) и точность (precision).

- **По умолчанию:** Во многих случаях, например в логистической регрессии, порог принятия решения равен 0.5.
- **Порог, равный 0.5:** Если вероятность принадлежности к положительному классу больше или равна 0.5, то объект классифицируется как положительный класс.
- **Изменение порога:** В зависимости от задачи, может быть полезно изменить порог. Например, если нужно повысить полноту (recall) за счет точности (precision), можно снизить порог.

## Влияние порога на метрики
Изменение порога влияет на такие метрики, как:
- **Точность (Accuracy):** Частота правильных классификаций.
- **Полнота (Recall):** Доля правильных положительных классификаций.
- **Точность (Precision):** Доля правильных положительных классификаций среди всех предсказанных положительных.

**Пример:** Если порог принятия решения установлен слишком высоко, модель будет классифицировать объекты как положительные только тогда, когда вероятность очень велика. Это может привести к низкой полноте (потому что некоторые положительные объекты будут классифицированы как отрицательные), но высокой точности.

## Применение порога в разных задачах
- **Медицинская диагностика:** В задачах, где важно не пропустить заболевания, может быть полезно установить низкий порог, чтобы захватить больше положительных случаев (повышение полноты).
- **Финансовые услуги:** В задачах, например, выявления мошенничества, можно установить более высокий порог для снижения ложных срабатываний (повышение точности).

## Выбор оптимального порога
Для выбора оптимального порога можно использовать:
1. **Кривую ROC (Receiver Operating Characteristic):** Она помогает найти баланс между точностью и полнотой для различных значений порога.
2. **Кривую Precision-Recall:** Полезна, если данные несбалансированы (например, в задаче классификации редких событий).
3. **Метод максимизации F1-меры:** Это гармоническое среднее точности и полноты, которое можно максимизировать для нахождения наилучшего порога.

## Пример
Допустим, модель классифицирует email как спам или не спам. Если вероятность того, что email является спамом, составляет 0.7, а порог принятия решения установлен на 0.5, то email будет классифицирован как спам.

---

## Полезные ссылки
[[18Метрики качества классификации(18)]]

