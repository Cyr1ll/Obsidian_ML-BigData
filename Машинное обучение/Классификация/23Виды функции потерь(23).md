# Виды функции потерь

#Функции_потерь
#Метод_оценки
## Введение
Функция потерь — это метод оценки того, насколько хорошо модель машинного обучения выполняет отображение входных данных (векторов признаков) в целевые значения. Чем меньше значение функции потерь, тем ближе предсказания модели к истинным значениям. 

Обозначения:
- $T(x)$ — прогнозируемое значение модели.
- $y$ — истинное значение.

Функции потерь делятся на категории в зависимости от типа задачи: **классификация**, **регрессия** и специализированные задачи.
Почитать - https://education.yandex.ru/handbook/ml/article/metriki-klassifikacii-i-regressii

---

## Функции потерь для задач классификации. 
#Классификация [[18Метрики качества классификации(18)]]

### Кросс-энтропия (Cross-Entropy Loss)
- **Описание**: Измеряет расхождение между двумя распределениями вероятностей (предсказанным и истинным). Чем меньше значение кросс-энтропии, тем более похожи распределения.
- **Для бинарной классификации**:
  $$
  L_{CE} = -\frac{1}{n} \sum_{i=1}^n \left[ y_i \log(T(x_i)) + (1 - y_i) \log(1 - T(x_i)) \right]
  $$
  где $T(x_i)$ — вероятность предсказания класса $y_i = 1$.
- **Особенности**:
  - Потери уменьшаются, когда предсказание приближается к истинной метке.

### Шарнирная функция потерь (Hinge Loss)
- **Описание**: Используется в методе опорных векторов (SVM). Наказывает модель за неправильные предсказания и за уверенность, близкую к границе решений.
- **Формула**:
  $$
  L_{Hinge}(T, x) = \max(0, 1 - y \cdot T(x))
  $$
  где $y \in \{-1, 1\}$.
- **Особенности**:
  - Значение функции равно $0$, если пример классифицирован правильно и с достаточной уверенностью.
  - Увеличивается по мере увеличения ошибки.

### Индикатор ошибки
- **Описание**: Показывает, совпадает ли предсказанное значение с истинным.
- **Формула**:
  $$
  L_{Error}(T, x) = \begin{cases} 
  0, & \text{если } T(x) = y(x) \\ 
  1, & \text{если } T(x) \neq y(x) 
  \end{cases}
  $$
- **Особенности**:
  - Простая, но редко используется в практике из-за дискретного характера.

---

## Функции потерь для задач регрессии. 
#Регрессия [[Метрики качества регрессии(19)]]

### Среднеквадратичная ошибка (Mean Squared Error, MSE)
- **Описание**: Среднее значение квадратов разности между предсказанными и истинными значениями.
- **Формула**:
  $$
  L_{MSE}(T, x) = \frac{1}{n} \sum_{i=1}^n \left( T(x_i) - y(x_i) \right)^2
  $$
- **Особенности**:
  - Чувствительна к выбросам, так как квадраты ошибок усиливают вклад больших отклонений.

### Средняя абсолютная ошибка (Mean Absolute Error, MAE)
- **Описание**: Среднее значение модулей разности между предсказанными и истинными значениями.
- **Формула**:
  $$
  L_{MAE}(T, x) = \frac{1}{n} \sum_{i=1}^n |T(x_i) - y(x_i)|
  $$
- **Особенности**:
  - Менее чувствительна к выбросам, чем MSE.

### Средняя ошибка смещения (Mean Bias Error, MBE)
- **Описание**: Средняя разность между предсказанными и истинными значениями.
- **Формула**:
  $$
  L_{MBE}(T, x) = \frac{1}{n} \sum_{i=1}^n \left( T(x_i) - y(x_i) \right)
  $$
- **Особенности**:
  - Используется для оценки систематических смещений модели.

### Потери Хьюбера (Huber Loss)
- **Описание**: Комбинация MSE и MAE. Для больших ошибок ведёт себя как MAE, а для малых — как MSE.
- **Формула**:
  $$
  L_{\delta}(a) =
  \begin{cases} 
  \frac{1}{2} a^2, & \text{если } |a| \leq \delta \\
  \delta \cdot (|a| - \frac{\delta}{2}), & \text{если } |a| > \delta
  \end{cases}
  $$
  где $a = T(x_i) - y(x_i)$.
- **Особенности**:
  - Подходит для данных с выбросами.

### Среднеквадратическая логарифмическая ошибка (Mean Squared Logarithmic Error, MSLE)
- **Описание**: Логарифмическая версия MSE, которая уменьшает влияние больших значений ошибок.
- **Формула**:
  $$
  L_{MSLE}(T, x) = \frac{1}{n} \sum_{i=1}^n \left( \log(T(x_i) + 1) - \log(y(x_i) + 1) \right)^2
  $$
- **Особенности**:
  - Используется для немасштабируемых величин.

### Логарифмические потери (Log-Cosh Loss)
- **Описание**: Принцип работы схож с MSE, но менее чувствителен к выбросам.
- **Формула**:
  $$
  L_{Log-Cosh}(T, x) = \sum_{i=1}^n \log(\cosh(T(x_i) - y(x_i)))
  $$
- **Особенности**:
  - Подходит для данных с редкими большими отклонениями.

### Квантильные потери (Quantile Loss, Pinball Loss)
- **Описание**: Используются в задачах предсказания квантилей, минимизируют асимметричную ошибку.
- **Формула**:
  $$
  L_{Quantile} = \frac{1}{n} \sum_{i=1}^n \max(\tau(T(x_i) - y(x_i)), (1 - \tau)(y(x_i) - T(x_i)))
  $$
  где $\tau$ — квантиль.

---

## Вывод
Функции потерь подбираются в зависимости от задачи и характеристик данных. Например:
- Для задач классификации: кросс-энтропия или шарнирная функция.
- Для задач регрессии: MSE или MAE.
- Для данных с выбросами: Хьюбера или Log-Cosh.

---

## Полезные ссылки
- [[20Метрики многоклассовой классификации(20)]]
- [[Линейная регрессия(33)]]
- [[Задача регрессионного анализа и классификации(14)]]
- [[Полиномиальная регрессия(45)]]
- https://education.yandex.ru/handbook/ml/article/metriki-klassifikacii-i-regressii
