# Парзеновские окна

## Введение
**Метод Парзеновского окна** — это метод байесовской классификации, основанный на непараметрическом восстановлении плотности вероятности по имеющейся выборке. Он позволяет оценивать плотность вероятности в произвольной точке пространства признаков, опираясь на соседние точки выборки.

---

## Основная идея
- Плотность вероятности выше в тех областях, где сосредоточено больше объектов выборки.
- Метод использует **оконные функции (ядра)**, чтобы сгладить распределение и оценить плотность вероятности с учетом соседних объектов.
- В отличие от метода $k$ ближайших соседей, где рассматривается фиксированное число соседей, метод Парзеновского окна фиксирует ширину окна ($h$), а число объектов в этом окне может варьироваться.

---

## Алгоритм использования Парзеновского окна
**![](https://lh7-rt.googleusercontent.com/docsz/AD_4nXewCdNuljXt01_RabyCzuC3lFyHuzqv8KZhcTmGlnRFh74xH6DItBCx_G1sK5qym9p1oT5iOJnmtFkBIdsHB1tIp_ci_DekN1DtGmY_fMKyW9x-NbfhN4DamWI04lzFm3Pjrrz15juD_HQV1M4Lcwke0byX?key=C1AMzwFdvttb7H1YBkknyQ)**
1. **Определение ядра и ширины окна**:
   - Ядро $K$ — это оконная функция, которая определяет вклад точки в оценку плотности (например, Гауссово, прямоугольное, треугольное ядро).
   - Ширина окна $h$:
     - Малое значение $h$ приводит к локализованной оценке (учитывает только ближайшие точки).
     - Большое значение $h$ приводит к сглаженной и плавной оценке.
2. **Выбор классифицируемого объекта**: Устанавливается вектор признаков для точки, в которой требуется оценить плотность.
3. **Построение $n$-мерного окна**: В центр координат исследуемой точки помещается $n$-мерный гиперкуб с длиной ребра $h$.
4. **Оценка плотности**: Для каждой точки выборки проверяется, находится ли она внутри окна, с учетом функции ядра $K$.

---

## Формула оценки плотности
Оценка плотности вероятности в точке $x$:
$$
\hat{f}(x) = \frac{1}{n h^d} \sum_{i=1}^n K \left( \frac{x - x_i}{h} \right),
$$
где:
- $n$ — количество объектов в выборке.
- $d$ — размерность пространства признаков.
- $K$ — оконная функция (ядро).
- $h$ — ширина окна.
- $x_i$ — объект обучающей выборки.

---

## Выбор ядра
Примеры популярных функций ядра $K$:
1. **Прямоугольное**:
   $$
   K(u) =
   \begin{cases}
   1, & \text{если } |u| \leq 1, \\
   0, & \text{если } |u| > 1.
   \end{cases}
   $$
2. **Треугольное**:
   $$
   K(u) =
   \begin{cases}
   1 - |u|, & \text{если } |u| \leq 1, \\
   0, & \text{если } |u| > 1.
   \end{cases}
   $$
3. **Гауссово**:
   $$
   K(u) = \frac{1}{\sqrt{2\pi}} e^{-\frac{u^2}{2}}.
   $$
4. **Епанечниково**:
   $$
   K(u) =
   \begin{cases}
   \frac{3}{4}(1 - u^2), & \text{если } |u| \leq 1, \\
   0, & \text{если } |u| > 1.
   \end{cases}
   $$

---

## Преимущества метода
1. Не требует предположений о форме распределения данных (непараметрический подход).
2. Гибкость за счёт выбора ядра и ширины окна.
3. Простота реализации и интерпретации.

---

## Недостатки метода
1. Выбор оптимальной ширины окна $h$ сложен и критически влияет на качество работы метода.
2. Высокая вычислительная сложность для больших выборок, особенно в высоких размерностях (проблема "проклятия размерности").
3. Чувствительность к выбросам и шуму в данных.

---

## Сравнение с методом $k$ ближайших соседей
| Метод                      | Парзеновские окна                | $k$ ближайших соседей               |
|----------------------------|-----------------------------------|--------------------------------------|
| **Фиксированный параметр** | Ширина окна $h$                  | Количество соседей $k$              |
| **Число соседей**          | Зависит от $h$                   | Заранее фиксировано                 |
| **Применимость**           | Гибче при сложных распределениях | Проще интерпретировать              |

---

## Вывод
Метод Парзеновского окна — мощный инструмент для оценки плотности вероятности и классификации, но требует внимательного выбора ширины окна и ядра. Его применение эффективно в задачах с ограниченным объёмом данных и низкой размерностью пространства признаков.

---

## Полезные ссылки
- [[Метод ближайших соседей kNN(46)]]
- [[Задача регрессионного анализа и классификации(14)]]
- [[Постановка задачи классификации(30_14&2)]]
- http://www.machinelearning.ru/wiki/index.php?title=Метод_Парзеновского_окна_%28пример%29
